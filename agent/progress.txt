# Progress Log

Starting work on authentication, SSO, and visualization features.

## Feature 1: Multi-tenancy Database Schema - COMPLETE
- PR #13 merged
- All tables and models created

## Feature 2: Auth - Core Authentication System - 2026-02-02
- What was done:
  - Added JWT (RS256, 4096-bit) authentication with golang-jwt/jwt/v5
  - Implemented Argon2id password hashing (time=3, memory=64MB, parallelism=4)
  - Created auth middleware for protected routes
  - Added endpoints: POST /api/auth/register, POST /api/auth/login, GET /api/auth/me
  - JWT includes: sub (user_id), email, name, exp, iat (15 min expiry)
  - Password validation: min 8 chars, uppercase, lowercase, digit
- Files changed:
  - backend/internal/auth/jwt.go - RSA key generation, token signing/verification
  - backend/internal/auth/password.go - Argon2id hash and verify
  - backend/internal/auth/middleware.go - JWT middleware for protected routes
  - backend/internal/handlers/auth.go - register, login, me endpoints
  - backend/cmd/api/main.go - added auth routes
  - backend/internal/auth/jwt_test.go - JWT tests
  - backend/internal/auth/password_test.go - password tests
  - backend/internal/handlers/auth_test.go - handler tests
- PR: #14

## Feature 4: Auth - Google SSO - 2026-02-02
- What was done:
  - Added golang.org/x/oauth2/google dependency for OAuth2 flow
  - Created backend/internal/handlers/sso_google.go with complete Google SSO implementation
  - GET /api/auth/google/login?org={slug} - Initiates OAuth flow, redirects to Google
  - GET /api/auth/google/callback - Exchanges code for token, gets user info
  - Auto-creates user if new, links to existing user if email matches
  - Adds user_auth_methods record (provider=google, provider_user_id)
  - Auto-adds new users to organization as viewer
  - POST /api/orgs/{id}/sso/google - Configure SSO (admin only)
  - GET /api/orgs/{id}/sso/google - Get SSO config (admin only)
  - State parameter stored in secure HTTP-only cookie
  - Callback redirects to frontend with access token in URL fragment
- Files changed:
  - backend/go.mod (added golang.org/x/oauth2)
  - backend/internal/handlers/sso_google.go (new)
  - backend/internal/handlers/sso_google_test.go (new)
  - backend/cmd/api/main.go (added SSO routes)
- PR: https://github.com/janhoon/dash/pull/16
